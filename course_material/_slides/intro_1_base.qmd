---
# title: It which shall not be named
format:
  revealjs:
    theme: FACE-IT_pres.scss
    self-contained: true
    transition: slide
editor: source
---

# It which shall not be named {background-color="#008980" style="text-align: center"}

*Robert Schlegel*

##

Now that we have covered the arguments about the merits of using R, let's double down and spend the next half-hour seeing first-hand why we think this. 

##

Please open the file 'course_material/data/sst_NOAA.csv' in MS Excel. Gasp! Yes I know. After all of that and now we are using MS Excel? But trust us, there is method to this madness. 

##

Your mission, should you choose to accept it, is to spend the next 30 minutes creating monthly climatologies and plotting them as a dot/line graph. 

##

The dataset we are using come from the NOAA OISST remotely sensed seawater temperature product. It contains data for three different regions, each about 38 years long. 

##

To complete this objective you will need to first split up the three different time series, and then figure out how to create a monthly climatology for each. 

##

A monthly climatology is the average temperature for a given month at a given place. So in this instance, because we have three time series, we will want 36 total values comprised of January - December monthly means for each site (if a time series is 30 years long, then a climatological December will be the mean temperature of all of the data within the 30 Decembers for which data are available). 

##

Once those values have been calculated, it should be a relatively easy task to plot them as a dot and line graph. Please keep an eye on the time, if you are not done within 30 minutes please stop anyway.

##

```{r, echo=FALSE}
library(countdown)
countdown(minutes = 30, seconds = 0, 
          start_immediately = TRUE, warn_when = 600, play_sound = TRUE,
          top = 0, bottom = 0, left = 0, right = 0,
          margin = "5%", font_size = "8em", update_every = 60)
```


##

Now that you've had some time to look at the data and work through the exercise in Excel, let's see how to do it in R.

##

First we will want to load some packages.

```{r}
library(tidyverse)
library(lubridate)
```

# With those packages loaded, R now knows the functions we will need to use to calculate the monthly climatologies for our three time series. We will also be able to make some pretty figures.

# Using excel may allow one to make small changes quickly, but rapidly becomes laborious when any sophistication is required. The few lines of code below make all of the calculations we need in order to produce the results we are after.

# Load data
SACTN_data <- read_csv("data/SACTN_day_1.csv")

# Load data
SACTN_data <- read_csv("../data/SACTN_day_1.csv")

# Create monthly climatologies
SACTN_monthly <- SACTN_data %>% 
  mutate(month = month(date, label = T)) %>% 
  group_by(site, month) %>% 
  summarise(temp = mean(temp, na.rm = T))


# And that is all there is to it. Load the data and use four short lines of code. But let's quickly make those bonus line plots while we're at it:
  

ggplot(data = SACTN_monthly, aes(x = month, y = temp)) +
  geom_point(aes(colour = site)) +
  geom_line(aes(colour = site, group = site)) +
  labs(x = "", y = "Temperature (°C)")


# And if we want three different panels we just add one line of code:
  

ggplot(data = SACTN_monthly, aes(x = month, y = temp)) +
  geom_point(aes(colour = site)) +
  geom_line(aes(colour = site, group = site)) +
  labs(x = "", y = "Temperature (°C)") +
  facet_wrap(~site, ncol = 1) # Create panels



<!-- Add timer to last slide -->